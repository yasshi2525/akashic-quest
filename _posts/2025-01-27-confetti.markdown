---
layout: post
title: "紙吹雪を作る"
date: 2025-01-27 18:00:00 +0900
categories: akashic
---

紙吹雪が舞う演出を作ってみましょう.

作業はブラウザ上で完結します. ツールのインストールは要りません.
コードを記述 → 実行 を繰り返すことで体感的な理解を目指します.

# 想定する読者

- JavaScript の基本的な命令 (変数, if, for) を聞いたことがあるが、自分でコードを書いたことはない
- Akashic Engine を使ったことがない

# 紙を作ろう

まずは 1 枚の紙を画面上に表示させましょう.
下記がスタート地点です. 画面の ▶️ ボタンを押すとプログラムが実行されます.
今は何も作ってないので何も起こりません. 4 行目の下記の文字が書かれたところにコードを書いていきます.

```javascript
// ゲーム本体の処理
```

{% include playground.html view="edit" preset="confetti/1" height=350 %}

早速ですが、以下のコードを 4 行目に書くと紙っぽいものが画面に表示されます.

```javascript
const paper = new g.FilledRect({
  scene,
  x: g.game.width / 2,
  y: 50,
  width: 25,
  height: 25,
  anchorX: 0.5,
  anchorY: 0.5,
  cssColor: "red",
});
scene.append(paper);
```

{% include playground.html view="edit" preset="confetti/2" height=400 %}

これは Akashic Engine のお作法なので覚えなくて大丈夫です.
この記事ではプログラムが出来上がっていく様子、「動き」というものはどうやって作ることができるのかを焦点に当てているので先に進みます.

# 紙を地面に落とす

画面に紙を表示できたので、地面に落としましょう.
紙吹雪っぽくしたいところですが、まずは一番コアなところである「落とす」を作ります.
落とすコードも Akashic Engine のお作法なので先に答えをお伝えします. 5-8 行目です.

```javascript
paper.onUpdate.add(() => {
  paper.y += 1;
  paper.modified();
});
```

▶️ を押して動作を確認してみましょう.

{% include playground.html view="edit" preset="confetti/3" height=400 %}

ここは動きに関するところなので解説します.
よくみるアニメーションは 1 秒間に何十回も描画命令を出すことで動いているように見せています.
Akashic Engine では `onUpdate.add(() => { /* 更新命令 */ })` というお作法でアニメーションさせることができます.
今回はここに `paper.y += 1` と書きました. これは紙としている四角の y 座標を 1 大きくするという意味です.
座標を 1 大きくすることを繰り返していくため真下に落ちていくように見えるのです.
